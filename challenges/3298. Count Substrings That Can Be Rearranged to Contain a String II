function validSubstringCount(word1, word2) {
    const freq = Array(26).fill(0);
    let cnt = 0;

    for (let ch of word2) {
        if (freq[ch.charCodeAt(0) - 'a'.charCodeAt(0)] === 0) {
            cnt++;
        }
        freq[ch.charCodeAt(0) - 'a'.charCodeAt(0)]++;
    }

    let j = 0, ans = 0;
    for (let i = 0; i < word1.length; i++) {
        if (--freq[word1.charCodeAt(i) - 'a'.charCodeAt(0)] === 0) {
            cnt--;
        }

        while (cnt === 0) {
            ans += (word1.length - i);
            if (++freq[word1.charCodeAt(j) - 'a'.charCodeAt(0)] === 1) {
                cnt++;
            }
            j++;
        }
    }
    return ans;
}
