public class Solution
{
    int _min = 0;
    int _max = 0;

    public bool ValidSquare(int[] p1, int[] p2, int[] p3, int[] p4)
    {
        _min = (p1[0] - p2[0]) * (p1[0] - p2[0]) + (p1[1] - p2[1]) * (p1[1] - p2[1]);
        if(_min == 0) return false;
        _max = _min;

        int d = (p1[0] - p3[0]) * (p1[0] - p3[0]) + (p1[1] - p3[1]) * (p1[1] - p3[1]);
        if (d == 0) return false;
        if (d > _min) _max = d; else _min = d;

        d = (p1[0] - p4[0]) * (p1[0] - p4[0]) + (p1[1] - p4[1]) * (p1[1] - p4[1]);
        if (d == 0 || (_min != _max && d != _min && d != _max)) return false;
        if (d > _min) _max = d; else _min = d;

        d = (p2[0] - p3[0]) * (p2[0] - p3[0]) + (p2[1] - p3[1]) * (p2[1] - p3[1]);;
        if (d == 0 || (_min != _max && d != _min && d != _max)) return false;
        if (d > _min) _max = d; else _min = d;

        d = (p2[0] - p4[0]) * (p2[0] - p4[0]) + (p2[1] - p4[1]) * (p2[1] - p4[1]);;
        if (d == 0 || (d != _min && d != _max)) return false;
        if (d > _min) _max = d; else _min = d;

        d = (p4[0] - p3[0]) * (p4[0] - p3[0]) + (p4[1] - p3[1]) * (p4[1] - p3[1]);;
        return d != 0 && (d == _min || d == _max);
    }
}
