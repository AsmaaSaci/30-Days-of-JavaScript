function possible(t, pts, M) {
  let mv = 0, ext = 0, bon = 0;
  for (const p of pts) {
    const req = Math.floor((t + p - 1) / p);
    if (ext >= req) { ext = 0; bon++; }
    else { let d = req - ext; mv += 2 * d - 1 + bon; ext = d - 1; bon = 0; }
    if (mv > M) return false;
  }
  return true;
}

var maxScore = function(pts, M) {
  if (M < pts.length) return 0;
  let lo = 1, hi = 1e18, ans = 0;
  while (lo <= hi) {
    let mid = lo + Math.floor((hi - lo) / 2);
    if (possible(mid, pts, M)) { ans = mid; lo = mid + 1; }
    else hi = mid - 1;
  }
  return ans;
};
