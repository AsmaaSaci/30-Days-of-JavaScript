public class Solution {
    public int NextGreaterElement(int n) {
        if(n <= 11)
            return -1;

        List<int> digs = new();
        while(n > 0)
        {
            digs.Insert(0, n%10);
            n /= 10;
        }
       
        int len = digs.Count;
        int preSmall = len-2;
        while(preSmall >= 0 && digs[preSmall] >= digs[preSmall+1])
        {
            preSmall--;
        }

        if(preSmall < 0)
            return -1;
        
        int right = len-1;
        while(right > preSmall && digs[right] <= digs[preSmall])
        {
            right--;
        }

        int[] digsArr = digs.ToArray();

        // swap preSmall, preSmall+1 digs:
        int tmp = digsArr[preSmall];
        digsArr[preSmall] = digsArr[right];
        digsArr[right] = tmp;
        
        if(preSmall+1 < len-1)
        {
            Array.Sort(digsArr, preSmall+1, len-preSmall-1);
        }

        long res = 0;
        
        foreach(int d in digsArr)
        {
            res *= 10;
            res += d;
        }

        return res > int.MaxValue ? -1 : (int)res;
    }
}
