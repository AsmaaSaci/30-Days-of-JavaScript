const MOD = 10**9 + 7; // Define the modulo value

/**
 * Function to calculate the number of combinations of the given number.
 * @param {string} num - The input number as a string.
 * @return {number} - The number of combinations.
 */
var numberOfCombinations = function(num) {
    const n = num.length; // Get the length of the input number
    const counts = Array.from({length: n}, () => new Array(n+1).fill(0)); // Initialize an array to store counts
    const allSameFlag = num.split('').every(c => c === num[0]); // Check if all digits in the number are the same
    
    // Initialize counts for the last digit
    for (let i = 0; i < n; i++) {
        counts[i][n] = num[i] !== '0' ? 1 : 0;
    }
    
    // Function to partially compare two substrings of the number
    const partialCompare = (i, j) => {
        if (i === j || allSameFlag) {
            return 0;
        } else if (num[i] !== num[j]) {
            return num[i] > num[j] ? i+1 : -(i+1);
        } else if (2*j - i === n || 2*j - i === n-1) {
            for (let k = 0; k < j-i; k++) {
                if (num[i+k] !== num[j+k]) {
                    return num[i+k] > num[j+k] ? i+k : -(i+k+1);
                }
            }
            return 0;
        } else {
            const idx = partialCompare(i+1, j+1);
            return idx===0 ? 0 : Math.abs(idx)-1 >= j ? 0 : idx;
        }
    }
    
    let ans = counts[0][n]; // Initialize the answer with the count for the last digit
    
    // Loop through the digits from right to left
    for (let j = n-1; j > 0; j--) {
        let k = n, total = 0;
        // Calculate counts for each digit
        for (let i = 0; i < j; i++) {
            if (num[i] !== '0') {
                while (k-j > j-i || (k-j === j-i && partialCompare(i, j) <= 0)) {
                    total = (total + counts[j][k]) % MOD; // Update the total count
                    k--;
                }
                counts[i][j] = total; // Store the count in the counts array
            }
        }
        ans = (ans + counts[0][j]) % MOD; // Update the answer
        counts.pop(); // Remove the last element from the counts array
    }
    return ans; // Return the final answer
};
