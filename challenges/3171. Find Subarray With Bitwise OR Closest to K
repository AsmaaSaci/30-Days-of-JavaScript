public class Solution {
    public int MinimumDifference(int[] nums, int k) {
        int[] binOr = new int[32];
        int sum = 0;
        int x = 0;
        int y = 0;
        Add(nums[0], binOr);
        int diff = Math.Abs(k - nums[0]);
        while(x < nums.Length && y < nums.Length)
        {
            if (x > y)
            {
                y++;
                if (y == nums.Length)
                {
                    break;
                }
                Add(nums[y], binOr);
                continue;
            }
            int value = Convert(binOr);
            diff = Math.Min(diff, Math.Abs(value - k));
            if (value > k)
            {
                Remove(nums[x], binOr);
                x++;
                continue;
            }
            if (diff == 0)
            {
                return 0;
            }
            y++;
            if (y == nums.Length)
            {
                break;
            }
            Add(nums[y], binOr);
        }
        return diff;
    }

    private void Add(int num, int[] binOr)
    {
        int bit = 0;
        while(num > 0)
        {
            if (num % 2 != 0)
            {
                binOr[bit] += 1; 
            }
            bit++;
            num = num / 2;
        }
    }

    private void Remove(int num, int[] binOr)
    {
        int bit = 0;
        while(num > 0)
        {
            if (num % 2 != 0)
            {
                binOr[bit] -= 1; 
            }
            bit++;
            num = num / 2;
        }
    }

    private int Convert(int[] binOr)
    {
        int sum = 0;
        for(int i=0; i<32; i++)
        {
            if (binOr[i] > 0)
            {
                sum += (int)Math.Pow(2, i);
            }
        }
        return sum;
    }
}
